{% extends 'base.html' %}
{% load cloudinary %}
{% block content %}
<div class="container container-medium py-4">
  <!-- Styled back button to match dashboard -->
  <a href="{% url 'dashboard' %}" class="btn btn-outline-dark btn-sm mb-3"><i class="bi bi-arrow-left"></i> Back</a>
  <div class="text-center mb-4">
    <h2 class="dashboard-heading d-inline-block mb-0">{{ child.name }}'s Gallery üñºÔ∏è</h2>
  </div>

  {% if artworks %}
    <div class="honeycomb-grid" role="list" aria-label="Artwork honeycomb grid">
      {% for artwork in artworks %}
        <div class="honeycomb-cell" role="listitem">
          <div class="honeycomb-media" aria-label="{{ artwork.title|default:'Artwork' }}">
            <!-- Top: image + click to expand -->
            <div class="honeycomb-top">
              <img src="{% cloudinary_url artwork.image fetch_format='auto' quality='auto' secure=True %}"
                   alt="{{ artwork.title|default:'Artwork' }}"
                   class="honeycomb-img"
                   loading="lazy"
                   width="400"
                   height="400">
              <button type="button"
                      class="honeycomb-open open-artwork-image"
                      data-bs-toggle="modal"
                      data-bs-target="#artworkImageModal"
                      data-img="{% cloudinary_url artwork.image fetch_format='auto' quality='auto' secure=True %}"
                      data-title="{{ artwork.title|default:'Artwork' }}"
                      data-desc="{{ artwork.description|default:'' }}"
                      data-date="{{ artwork.created_at|date:'M d, Y' }}"
                      data-edit="{% url 'edit_artwork' child_id=child.id artwork_id=artwork.id %}">
                <span class="visually-hidden">Open ‚Äú{{ artwork.title|default:'Artwork' }}‚Äù</span>
              </button>
            </div>

            <!-- Bottom: title + date only (reverted actions) -->
            <div class="honeycomb-bottom">
              <h3 class="honeycomb-title mb-0">{{ artwork.title }}</h3>
              <small class="honeycomb-date d-block">{{ artwork.created_at|date:'M d, Y' }}</small>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p class="text-muted text-center">No artworks uploaded yet.</p>
  {% endif %}
</div>

<!-- Image modal used by gallery.js -->
<div class="modal fade" id="artworkImageModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content modal-honey">
      <div class="modal-body text-center p-0">
        <button type="button" class="btn-close position-absolute end-0 m-3" data-bs-dismiss="modal" aria-label="Close"></button>
        <img src="" alt="" class="img-fluid rounded" id="artworkImageModalImg">
        <!-- Caption + edit action in modal -->
        <div class="d-flex align-items-start justify-content-between gap-2 p-3">
          <div class="text-start flex-grow-1">
            <h5 id="artworkImageModalTitle" class="mb-1"></h5>
            <small id="artworkImageModalDate" class="modal-date d-block mb-1" aria-live="polite"></small>
            <p id="artworkImageModalDesc" class="mb-0 text-muted"></p>
          </div>
          <a id="artworkImageModalEdit" href="#" class="btn btn-honey-ghost" aria-label="Edit artwork">
            <i class="bi bi-pencil-square" aria-hidden="true"></i>
            <span class="ms-1">Edit</span>
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %}
